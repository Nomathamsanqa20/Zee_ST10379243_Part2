@model IEnumerable<Zee_ST10379243_Part2.Models.Donation>

@{
    ViewData["Title"] = "All Donations";
}

<div class="container mt-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold">
            <i class="fas fa-hand-holding-heart text-success"></i> All Donations
        </h2>
        <a asp-action="Create" class="btn btn-success btn-lg shadow-sm">
            <i class="fas fa-plus"></i> Make Donation
        </a>
    </div>

    @if (!Model.Any())
    {
        <div class="alert alert-info shadow-sm">
            <i class="fas fa-info-circle"></i> No donations have been made yet.
        </div>
    }
    else
    {
        <div class="row">
            @foreach (var donation in Model)
            {
                <div class="col-md-6 col-lg-4 mb-4">
                    <div class="card h-100 shadow-sm border-0 rounded-3">
                        <div class="card-header d-flex justify-content-between align-items-center bg-light">
                            <span class="badge bg-@GetDonationTypeColor(donation.DonationType) px-3 py-2">
                                @donation.DonationType
                            </span>
                            <small class="text-muted">@donation.DonationDate.ToString("MMM dd, yyyy")</small>
                        </div>
                        <div class="card-body">
                            <h6 class="card-title fw-bold">@donation.ItemDescription</h6>
                            <p class="card-text">
                                <strong>Quantity:</strong> @donation.Quantity @donation.Unit <br />
                                <strong>Target Area:</strong> @donation.TargetArea <br />
                                <strong>Donor:</strong> @donation.User?.FirstName @donation.User?.LastName
                            </p>
                        </div>
                        <div class="card-footer bg-white">
                            <span class="badge bg-@GetStatusColor(donation.Status) px-3 py-2">@donation.Status</span>
                            @if (!string.IsNullOrEmpty(donation.SpecialInstructions))
                            {
                                <small class="text-muted d-block mt-2">
                                    <i class="fas fa-info-circle"></i> @donation.SpecialInstructions
                                </small>
                            }
                        </div>
                    </div>
                </div>
            }
        </div>

        <div class="mt-5">
            <div class="alert alert-success shadow-sm">
                <h5 class="fw-bold"><i class="fas fa-chart-line"></i> Donation Summary</h5>
                <p class="mb-1">
                    <strong>Total Donations:</strong> @Model.Count()
                </p>
                <p>
                    <strong>Recent Donations:</strong> @Model.Count(d => d.DonationDate > DateTime.UtcNow.AddDays(-7)) in the last 7 days
                </p>
            </div>
        </div>
    }
</div>

@functions {
    string GetDonationTypeColor(string type)
    {
        return type?.ToLower() switch
        {
            "food" => "warning",
            "clothing" => "info",
            "medical" => "danger",
            "money" => "success",
            _ => "secondary"
        };
    }

    string GetStatusColor(string status)
    {
        return status?.ToLower() switch
        {
            "pending" => "warning",
            "received" => "info",
            "distributed" => "success",
            "cancelled" => "danger",
            _ => "secondary"
        };
    }
}
